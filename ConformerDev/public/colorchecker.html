{% extends 'basic.html' %}

{% block content %}
<head>
    <style media="screen">
      @import url('https://fonts.googleapis.com/css?family=Ubuntu');

    html, body {
      background: #ddd;
      font-family: Ubuntu, sans-serif;
      font-size: 16px;
    }

    h1, h2 {
      text-align: center;
      display: block;
      margin-top: 0;
    }

    /* Tool general styles */
    #color-contrast {
      background: #fff;
      box-shadow: 0 0 1rem rgba(0,0,0,0.25);
      border-radius: 2px;
      width: 1000px;
      margin: auto;
      box-sizing: border-box;
      padding: 2rem;
      /*position: absolute;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);*/
    }

    /* character */
    #jill {
      width: 250px;
      height: 250px;
      margin: auto auto;
      border-radius: 100%;
    }

    /* SVG */
    @-moz-keyframes blink {
      0%  { ry: 5; }
      49% { ry: 5; }
      50% { ry: 0; }
      51% { ry: 5; }
    }
    @-webkit-keyframes blink {
      0%  { ry: 5; }
      49% { ry: 5; }
      50% { ry: 0; }
      51% { ry: 5; }
    }
    @keyframes blink {
      0%  { ry: 5; }
      49% { ry: 5; }
      50% { ry: 0; }
      51% { ry: 5; }
    }
    .skin { fill: #eab38f; }
    .eyes { fill: #1f1f1f; animation: blink 10s alternate infinite; -webkit-animation: blink 10s alternate infinite; -moz-animation: blink 10s alternate infinite;}
    .hair { fill: #2f1b0d; }
    .line { fill: none; stroke: #2f1b0d; stroke-width:2px; }
    .arm, #mouth, #smile, .eyes, .hand, .eyebrow { transition: all 0.25s; }

    /* boxes */
    #boxes {
      display: flex;
      margin-top: 1.5rem;
    }

    #boxes > div {
      flex: 1;
      text-align: center;
      background: #081;
      color: white;
      padding: 0.5rem 0;
      margin-left: 10px;
      border-radius: 3px;
      transition: background 0.5s;
      position: relative;
    }

    #boxes > div::after {
      content: "✓ Pass";
      display: block;
      position: absolute;
      color: #000;
      text-align:center;
      width: 100%;
      margin-top: 10px;
    }

    #boxes > div.fail {
      background: #d32;
    }

    #boxes > div.fail::after {
      content: "✕ Fail";
    }

    #boxes > div:first-child {
      margin-left: 0;
    }

    #boxes span:first-child {
      font-size: 0.75em;
      display: inline-block;
      margin-bottom: 0.5em;
    }

    /* demo */
    #sample-text {
      margin: 2.5rem 0 1.6rem 0;
      padding: 1rem;
      background: #fff;
      color: #000;
      text-align: center;
      font-size: 20px;
      border-radius: 2px;
    }

    /* sliders */
    #bars {
      display: flex;
      flex-direction: row;
    }

    #bars > div {
      flex: 1;
      display: flex;
      flex-direction: column;
    }

    #bars > div:first-child {
      margin-right: 0.5rem;
    }

    #bars > div:last-child {
      margin-left: 0.5rem;
    }

    #bars > div > div {
      display: flex;
      margin-bottom: 0.5rem;
    }

    #bars label {
      display: inline-block;
      color: white;
      width: 2rem;
      height: 2rem;
      line-height: 2rem;
      font-size: 1rem;
      text-align: center;
      border-radius: 2px;
      box-sizing: border-box;
    }

    label.red { background: #d32; }
    label.green { background: #081; }
    label.blue { background: #26e; }

    #bars input[type="range"] {
      flex: 1;
    }
    #bars input[type="number"] {
      text-align: center;
      width: 3rem;
      border-radius: 2px;
      border: 1px solid #ccc;
      font-size: 0.75rem;
      height: 2rem;
      box-sizing:border-box;
      line-height: 2rem;
    }
    #bars input[type="text"] {
      border-radius: 2px;
      border: 1px solid #ccc;
      text-align: center;
      font-size: 1rem;
      height: 2rem;
      box-sizing:border-box;
      line-height: 2rem;
    }
    </style>
</head>
<div class="row">
  <div class="col-md-8">
<br>
<br>
<section id="color-contrast">
  <h1>Color Contrast Checker </h1>
  <div class="character">
    <div id="jill">

    </div>
  </div>
  <div id="boxes">
    <div id="aa-large">
      <span>Large Text</span>
      <span>WCAG AA</span>
    </div>
    <div id="aa-normal">
      <span>Normal Text</span>
      <span>WCAG AA</span>
    </div>
    <div id="aaa-large">
      <span>Large Text</span>
      <span>WCAG AAA</span>
    </div>
    <div id="aaa-normal">
      <span>Normal Text</span>
      <span>WCAG AAA</span>
    </div>
  </div>
  <div id="sample">
    <div contenteditable id="sample-text" style="color:rgb(0,0,0);background:rgb(255,255,255)">
      Click to change demo text
    </div>
  </div>
  <div id="bars">
    <div>
      <h2>Foreground</h2>
      <div>
        <label for="color-1-r" class="red">R</label>
        <input id="color-1-r" type="range" min="0" max="255" value="0" />
        <input id="number-1-r" type="number" min="0" max="255" value="0" />
      </div>
      <div>
        <label for="color-1-g" class="green">G</label>
        <input id="color-1-g" type="range" min="0" max="255" value="0" />
        <input id="number-1-g" type="number" min="0" max="255" value="0" />
      </div>
      <div>
        <label for="color-1-b" class="blue">B</label>
        <input id="color-1-b" type="range" min="0" max="255" value="0" />
        <input id="number-1-b" type="number" min="0" max="255" value="0" />
      </div>
      <input id="color-1-hex" data-target="1" type="text" value="#000000" maxlength="7" />
    </div>
    <div>
      <h2>Background</h2>
      <div>
        <label for="color-2-r" class="red">R</label>
        <input id="color-2-r" type="range" min="0" max="255" value="255" />
        <input id="number-2-r" type="number" min="0" max="255" value="255" />
      </div>
      <div>
        <label for="color-2-g" class="green">G</label>
        <input id="color-2-g" type="range" min="0" max="255" value="255" />
        <input id="number-2-g" type="number"min="0" max="255" value="255" />
      </div>
      <div>
        <label for="color-2-b" class="blue">B</label>
        <input id="color-2-b" type="range" min="0" max="255" value="255" />
        <input id="number-2-b" type="number" min="0" max="255" value="255" />
      </div>
      <input id="color-2-hex" data-target="2" type="text" value="#FFFFFF" maxlength="7" />
    </div>
  </div>
</section>

<script>
console.log("this is test");


function updateDemoColors(colorFront, colorBack) {
const demo = document.querySelector("#sample-text");
demo.style.color = `rgb(${colorFront.toString()})`;
demo.style.backgroundColor = `rgb(${colorBack.toString()})`;
}

function luminanace(r, g, b) {
var a = [r, g, b].map(function (v) {
  v /= 255;
  return v <= 0.03928
    ? v / 12.92
  : Math.pow( (v + 0.055) / 1.055, 2.4 );
});
return a[0] * 0.2126 + a[1] * 0.7152 + a[2] * 0.0722;
}
function contrast(rgb1, rgb2) {
const luminanceFront = luminanace(rgb1[0], rgb1[1], rgb1[2]);
const luminanceBack  = luminanace(rgb2[0], rgb2[1], rgb2[2]);
return luminanceBack > luminanceFront
  ? ((luminanceFront + 0.05) / (luminanceBack + 0.05))
  : ((luminanceBack + 0.05) / (luminanceFront + 0.05));
}

function updateBoxesColors(colorFront, colorBack) {
const ratio = contrast(colorFront, colorBack);
document.querySelector("#aa-normal").className  = ratio < 0.22222 ? "" : "fail";
document.querySelector("#aa-large").className   = ratio < 0.33333 ? "" : "fail";
document.querySelector("#aaa-normal").className = ratio < 0.14285 ? "" : "fail";
document.querySelector("#aaa-large").className  = ratio < 0.22222 ? "" : "fail";

const totalWrong = document.querySelectorAll(".fail").length;
let mouth = document.querySelector("#mouth");
let smile = document.querySelector("#smile");

switch(totalWrong) {
  case 0:
    mouth.setAttribute("d", "M 106,132 C 113,127 125,128 125,132 125,128 137,127 144,132 141,142  134,149  125,149  116,149 109,142 106,132 Z");
    smile.setAttribute("d", "M125,144 C 140,144 143,132 143,132 143,132 125,133 125,133 125,133 106.5,132 106.5,132 106.5,132 110,144 125,144 Z");
    break;
  case 1:
  case 2:
    mouth.setAttribute("d", "M 106,132 C 113,127 125,128 125,132 125,128 137,127 144,132 141,142  134,146  125,146  116,146 109,142 106,132 Z");
    smile.setAttribute("d", "M125,141 C 140,141 143,132 143,132 143,132 125,133 125,133 125,133 106.5,132 106.5,132 106.5,132 110,141 125,141 Z");
    break;
  case 3:
    mouth.setAttribute("d", "M 106,132 C 113,127 125,128 125,132 125,128 137,127 144,132 141,138  140,143  125,143  110,143 109,138 106,132 Z");
  smile.setAttribute("d", "M125,138 C 140,138 143.5,132 143.5,132 143.5,132 125,133 125,133 125,133 106.5,132 106.5,132 106.5,132 110,138 125,138 Z");
    break;
  case 4:
    mouth.setAttribute("d", "M 106,132 C 113,127 125,128 125,132 125,128 137,127 144,132 141,138  134,142  125,142  116,142 109,138 106,132 Z");
    smile.setAttribute("d", "M125,135 C 140,135 143,132 143,132 143,135 125,136 125,136 125,136 106.5,135 106.5,132 106.5,132 110,135 125,135 Z");
    break;
}
}

function updateHex(colorFront, colorBack) {
const colorFrontHex = colorFront.map(function(el) { return Number(el).toString(16).padStart(2, "0").toUpperCase(); });
const colorBackHex = colorBack.map(function(el) { return Number(el).toString(16).padStart(2, "0").toUpperCase(); });
document.querySelector("#color-1-hex").value = `#${colorFrontHex.join('')}`;
document.querySelector("#color-2-hex").value = `#${colorBackHex.join('')}`
}

function updateColors() {
const colorFront = [
  document.querySelector("#color-1-r").value,
  document.querySelector("#color-1-g").value,
  document.querySelector("#color-1-b").value
];
const colorBack = [
  document.querySelector("#color-2-r").value,
  document.querySelector("#color-2-g").value,
  document.querySelector("#color-2-b").value
];

updateDemoColors(colorFront, colorBack);
updateBoxesColors(colorFront, colorBack);
updateHex(colorFront, colorBack);
}

document.querySelectorAll("input[type='number'], input[type='range']").forEach(function(el) {
el.addEventListener("input", function() {
  if (this.type === "range") {
    this.nextElementSibling.value = this.value;
  } else if (this.type === "number") {
    this.previousElementSibling.value = this.value;
  }
  updateColors();
});
});

document.querySelectorAll("input[type='text']").forEach(function(el) {
el.addEventListener("blur", function() {
  let val = this.value;
  let wrongValue = false;
  if (val[0] === "#") val = val.substring(1);
  if (val.length === 3 || val.length === 6) {
    if (val.length === 3) {
      val = `${val[0]}${val[0]}${val[1]}${val[1]}${val[2]}${val[2]}`;
    }
    if (val.match(/[0-9A-Fa-f]{6}/)) {
      const red = parseInt(`${val[0]}${val[1]}`, 16);
      const green = parseInt(`${val[2]}${val[3]}`, 16);
      const blue = parseInt(`${val[4]}${val[5]}`, 16);
      const target = this.dataset.target;

      document.getElementById(`number-${target}-r`).value = red;
      document.getElementById(`number-${target}-g`).value = green;
      document.getElementById(`number-${target}-b`).value = blue;
      document.getElementById(`color-${target}-r`).value = red;
      document.getElementById(`color-${target}-g`).value = green;
      document.getElementById(`color-${target}-b`).value = blue;

      updateColors();
    } else {
      wrongValue = true;
    }
  } else {
    wrongValue = true;
  }

  if (wrongValue){
    const colorFront = [
      document.querySelector("#color-1-r").value,
      document.querySelector("#color-1-g").value,
      document.querySelector("#color-1-b").value
    ];
    const colorBack = [
      document.querySelector("#color-2-r").value,
      document.querySelector("#color-2-g").value,
      document.querySelector("#color-2-b").value
    ];
    updateHex(colorFront, colorBack)
  }
});
})
  </script>
</div>

</div>

{% endblock %}
